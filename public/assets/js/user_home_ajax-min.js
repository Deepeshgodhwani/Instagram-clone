const toggleBar=()=>{$("#message").css({display:"none"})},statusMessage=e=>{$("#message").text(e),$("#message").css({display:"flex"}),setTimeout(toggleBar,2e3)};var preloader=function(){$("#loading").css({width:"0",height:"0",overflow:"hidden",position:"absolute"})};class FollowUnfollow{constructor(e){this.btn=e,this.onToggle()}onToggle(){$(this.btn).click(function(e){e.preventDefault();let t=this;$.ajax({type:"get",url:$(t).attr("href"),success:function(e){"followed"==e.data.type?($(t).css({color:"black"}),$(t).text("Following")):($(t).text("Follow"),$(t).css({color:"rgb(0,149,246)"}))},error:function(e){statusMessage("Something went wrong. Please try again.")}})})}}class ToggleLike{constructor(e){this.toggler=e,this.toggleLike()}toggleLike(){$(this.toggler).click(function(e){e.preventDefault();let t=this,r=$("#red",t),l=$("#white",t);$.ajax({type:"get",url:$(t).attr("href"),success:function(e){let a=parseInt($(t).attr("data-likes"));1==e.data.Deleted?(a-=1,r.removeClass("fa-solid fa-heart"),r.addClass("fa-regular fa-heart"),$("div",t).removeClass("animate__animated animate__pulse"),l.removeClass("fa-solid fa-heart"),l.addClass("fa-regular fa-heart"),l.css({color:"black"}),r.css({color:"black"})):(a+=1,$("div",t).addClass("animate__animated animate__pulse"),l.removeClass("fa-regular fa-heart"),l.addClass("fa-solid fa-heart"),r.removeClass("fa-regular fa-heart"),r.addClass("fa-solid fa-heart"),l.css({color:"rgb(237, 73, 86)"}),r.css({color:"rgb(237, 73, 86)"})),$(t).attr("data-likes",a);let s=$(`.${$(t).attr("postId")}`);0==a&&s.remove(),s.length?s.text(`${a} likes`):$(`.head${$(t).attr("postId")}`).prepend(`<div class=${$(t).attr("postId")} id="total-likes">\n                                      ${a} likes\n                                </div>`)},error:function(e){statusMessage("Something went wrong. Please try again.")}})})}}class DeletePost{constructor(e){this.posts=e,this.deletePost()}deletePost(){$(this.posts).click(function(e){e.preventDefault(),$.ajax({type:"get",url:$(this).attr("href"),success:function(e){$(`.d-${e.data.post_id}`).remove(),statusMessage("Post deletd")},error:function(e){console.log("error in deleting post through ajax",e),statusMessage("Something went wrong. Please try again.")}})})}}$("#container").click(function(){$(".searchResult").css({display:"none"}),$("#close").css({display:"none"}),$("#logo").css({display:"flex"}),$(".loading-bar").css({display:"none"}),$(".search").val(""),$(".dropDown").css({display:"none"})}),$(".comment-form").submit(function(e){e.preventDefault();$.ajax({type:"post",url:$(this).attr("action"),data:$(this).serialize(),success:function(e){let t=$(`.Comment${e.comment.post}`),r=$(`.count${e.comment.post}`),l=parseInt(r.attr("commentCount"));l+=1,console.log(l),t.empty(),l>=2?t.append(`\n                <a class="count${e.comment.post}" commentCount=${l} style="text-decoration:none ;" href="/user/post/postView/${e.comment.post}"> \n                   <div  id="total-comments">\n                     view all ${l} comments\n                    </div>\n                  </a>`):(console.log("hey"),t.append(`<div class="count${e.comment.post}" commentCount=${l}> \n                </div>`)),t.append(`<div  id="commentBox" > \n             <p class="Username">\n                ${e.comment.user.username}\n             </p>\n             <p class="Content">\n               ${e.comment.content.slice(0,30)}.. \n             </p>\n           </div>`),$(`.Input${e.comment.post}`).val(""),statusMessage("Comment Posted")},error:e=>{statusMessage("Something went wrong. Please try again.")}})});var doComment=e=>{$(`.${e}`).focus()};const allStories=[{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676100101/Instagram-clone/michelMusso.dp_rsiknz.jpg",username:"mitchelmusso",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676100102/Instagram-clone/michelMusso_fzbc5r.jpg",title:"Title No. 1"},{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676099296/Instagram-clone/andrieu_zulfpy.jpg",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676099744/Instagram-clone/andriuStory_riwhuf.jpg",title:"Title No. 2",username:"andreideiu_"},{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1675965596/Instagram-clone/postMalone_udsqy9.jpg",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1675965771/Instagram-clone/story_xude5r.jpg",title:"Title No. 3",username:"postmalone"},{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1675964949/Instagram-clone/carryminati_lc5z6b.jpg",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1675966347/Instagram-clone/carryminati-story_p73xxs.jpg",title:"Title No. 4",username:"carryminati"},{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676100784/Instagram-clone/jackmorris_dp_fol4by.jpg",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676100782/Instagram-clone/jackmorris_story_ab19dm.jpg",title:"Title No. 5",username:"jackmorris"},{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676101109/Instagram-clone/harrymackdp_odstwy.png",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676101115/Instagram-clone/harryMackStory_shr5e6.jpg",title:"Title No. 6",username:"harrymack"},{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676101410/Instagram-clone/hardwelldp_rxdy9j.jpg",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676101407/Instagram-clone/hardwellstory_ddu2yx.jpg",title:"Title No. 7",username:"hardwell"},{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676101764/Instagram-clone/johnDavid_dp_arv8v9.jpg",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676101768/Instagram-clone/johnDavidStory_ltxbka.jpg",title:"Title No. 8",username:"johndavid"},{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676102114/Instagram-clone/jenaissante_dp_hwhrcx.jpg",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676102118/Instagram-clone/jenaissante_story_y2tn9v.jpg",title:"Title No. 9",username:"jenaissante"},{thumbUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676102746/Instagram-clone/brunomarsdp_ydkeem.jpg",imageUrl:"https://res.cloudinary.com/dynjwlpl3/image/upload/v1676102864/Instagram-clone/brunomars_story_fyrwst.jpg",title:"Title No. 10",username:"brunomars"}],storiesContainer=document.querySelector(".stories-container"),storyFull=document.querySelector(".story-full"),storyFullImage=document.querySelector(".story-full img"),storyFullTitle=document.querySelector(".story-full .title"),closeBtn=document.querySelector(".story-full .close-btn"),leftArrow=document.querySelector(".story-full .left-arrow"),rightArrow=document.querySelector(".story-full .right-arrow"),ProfilePic=document.querySelector(".story-full .profileGroup .dp"),username=document.getElementById("uName"),blackground=document.getElementById("bg"),rightScroll=document.getElementById("right"),leftScroll=document.getElementById("left");let timer,currentIndex=0;allStories.forEach((e,t)=>{const r=document.createElement("div");r.classList.add("story");const l=document.createElement("div"),a=document.createElement("p");l.classList.add("content"),a.innerHTML=e.username;const s=document.createElement("img");s.setAttribute("src",e.thumbUrl),l.appendChild(s),r.appendChild(l),r.appendChild(a),storiesContainer.appendChild(r),l.addEventListener("click",()=>{currentIndex=t,storyFull.classList.add("active"),storyFullImage.setAttribute("src",e.imageUrl),ProfilePic.setAttribute("src",e.thumbUrl),username.innerHTML=e.username,clearInterval(timer),timer=setInterval(nextStory,3e3)})}),leftScroll.addEventListener("click",()=>{storiesContainer.scrollLeft-=200}),rightScroll.addEventListener("click",()=>{storiesContainer.scrollLeft+=200}),closeBtn.addEventListener("click",()=>{storyFull.classList.remove("active")}),bg.addEventListener("click",()=>{storyFull.classList.remove("active")}),leftArrow.addEventListener("click",()=>{currentIndex>0&&(currentIndex-=1,storyFullImage.setAttribute("src",allStories[currentIndex].imageUrl),ProfilePic.setAttribute("src",allStories[currentIndex].thumbUrl),username.innerHTML=allStories[currentIndex].username,clearInterval(timer),timer=setInterval(nextStory,3e3))});const nextStory=()=>{currentIndex<allStories.length-1&&(currentIndex+=1,storyFullImage.setAttribute("src",allStories[currentIndex].imageUrl),ProfilePic.setAttribute("src",allStories[currentIndex].thumbUrl),username.innerHTML=allStories[currentIndex].username)};rightArrow.addEventListener("click",()=>{nextStory(),clearInterval(timer),timer=setInterval(nextStory,3e3)});